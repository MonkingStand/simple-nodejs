<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="天台医共体智慧云平台启动仪式签到">
    <meta name="keywords" content="天台医共体,智慧云平台">
    <meta property="og:title" content="天台医共体智慧云平台">
    <meta property="og:description" content="天台医共体智慧云平台启动仪式签到">
    <meta property="og:image" content="//come-future.oss-cn-beijing.aliyuncs.com/check-in/logo.png">
    <title>天台医共体智慧云平台</title>
    <link type="image/png" href="//come-future.oss-cn-beijing.aliyuncs.com/check-in/logo.png" rel="shortcut icon">
    <style>
      /* reset */
      *{box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}html{font-family:"Helvetica Neue",Helvetica,STHeiTi,Arial,sans-serif;height:100%;overflow-x:hidden;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{height:100%;overflow-x:hidden;margin:0;line-height:1.5;color:#333;background-color:white;height:100%;overflow-x:hidden;-webkit-overflow-scrolling:touch}body,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,code,form,fieldset,legend,input,textarea,p,blockquote,th,td,hr,button,article,aside,details,figcaption,figure,footer,header,menu,nav,section{margin:0;padding:0;border:0}a{background:transparent;text-decoration:none;-webkit-tap-highlight-color:transparent;color:orange}s a:active{outline:0;color:crimson}address,cite,dfn,em,i,var{font-style:normal}button{user-select:none}img{vertical-align:middle}img:not([src]),img[src=""]{opacity:0}ul,ol{list-style:none}table{border-collapse:collapse;border-spacing:0}input,select,button,textarea{font-size:100%;font:inherit}
    </style>
    <style>
      /* customization */
      /* 主界面 slogan 相关 */
      .main {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        overflow-x: hidden;
        overflow-y: auto;
        background: #fff url(https://come-future.oss-cn-beijing.aliyuncs.com/check-in/bg.jpg) no-repeat center center / cover;
      }
      .container {
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        z-index: 9;
      }
      .slogan {
        display: flex;
        height: 4vh;
        margin-top: 5vh;
        align-items: center;
        justify-content: center;
      }
      .slogan img {
        height: 100%;
        padding: 0;
        margin: 0;
      }
      .check-in-title {
        display: flex;
        height: 5vh;
        margin-top: 25vh;
        align-items: center;
        justify-content: center;
      }
      .check-in-title img {
        height: 100%;
      }
      .check-in-sub-title {
        display: flex;
        height: 2.5vh;
        margin-top: 2.5vh;
        align-items: center;
        justify-content: center;
      }
      .check-in-sub-title img {
        height: 100%;
      }
      .check-in-date {
        display: flex;
        height: 16px;
        margin-top: 2.5vh;
        align-items: center;
        justify-content: center;
      }
      .check-in-date img {
        height: 100%;
      }
      /* 提示下滑 */
      @keyframes move {
        25% {
            opacity: 1;
        }
        33% {
            opacity: 1;
            transform: translateY(30px);
        }
        67% {
            opacity: 1;
            transform: translateY(40px);
        }
        100% {
            opacity: 0;
            transform: translateY(55px) scale3d(0.5, 0.5, 0.5);
        }
      }
      @keyframes pulse {
          to {
              opacity: 1;
          }
      }
      .scroll-down-tips {
          position: absolute;
          display: flex;
          left: 0;
          right: 0;
          top: 87.5vh;
          justify-content: center;
          align-items: center;
      }
      .scroll-down-tips.hidden {
        display: none;
      }
      .scroll-down-tips .chevron {
          position: absolute;
          width: 12px;
          height: 2px;
          opacity: 0;
          transform: scale3d(0.5, 0.5, 0.5);
          animation: move 3s ease-out infinite;
      }
      .scroll-down-tips .chevron:first-child {
          animation: move 3s ease-out 1s infinite;
      }
      .scroll-down-tips .chevron:nth-child(2) {
          animation: move 3s ease-out 2s infinite;
      }
      .scroll-down-tips .chevron:before,
      .scroll-down-tips .chevron:after {
          content: ' ';
          position: absolute;
          top: 0;
          height: 100%;
          width: 51%;
          background: #fff;
      }
      .scroll-down-tips .chevron:before {
          left: 0;
          transform: skew(0deg, 45deg);
      }
      .scroll-down-tips .chevron:after {
          right: 0;
          width: 50%;
          transform: skew(0deg, -45deg);
      }
      .scroll-down-tips .text {
          display: block;
          font-family: "Helvetica Neue", "Helvetica", Arial, sans-serif;
          font-size: 13px;
          color: #fff;
          text-transform: uppercase;
          white-space: nowrap;
          opacity: .25;
          animation: pulse 2s linear alternate infinite;
      }
      /* 下滑动画 */
      @keyframes slideUp {
        0% {
          transform: translateY(-100vh);
        }
        100% {
          transform: translateY(0vh);
        }
      }
      @keyframes slideDown {
        0% {
          transform: translateY(0vh);
        }
        100% {
          transform: translateY(-100vh);
        }
      }
      .container.uncheck-in {
        transform: translateY(0);
        animation: slideUp 0.5s ease;
      }
      .container.check-in {
        transform: translateY(-100vh);
        animation: slideDown 0.5s ease;
      }
      /* 签到表单 */
      .check-in-form {
        position: absolute;
        display: block;
        height: 100vh;
        top: 100vh;
        left: 0;
        right: 0;
        overflow-y: auto;
        overflow-x: hidden;
      }
      .check-in-form .check-form-title {
        position: absolute;
        display: flex;
        height: 40px;
        top: 17.5vh;
        left: 10vw;
        right: 10vw;
        margin-top: -38px;
        align-items: center;
        justify-content: center;
        border-radius: 10px 10px 0 0;
        background-color: #fff;
      }
      .check-in-form .check-form-title img {
        height: 100%;
      }
      .check-in-form form {
        position: absolute;
        top: 17.5vh;
        left: 10vw;
        right: 10vw;
        padding: 10px;
        border-radius: 0 0 10px 10px;
        background-color: #fff;
      }
      .check-in-form .form-item {
        margin-bottom: 15px;
      }
      .check-in-form .form-item .error-tips {
        display: none;
        height: 20px;
        line-height: 20px;
        color: #fb5531;
        font-size: 12px;
      }
      .check-in-form .form-item.error .error-tips {
        display: block;
      }
      .check-in-form .form-item label {
        display: block;
        height: 20px;
        line-height: 20px;
        font-size: 13px;
        color: #333;
      }
      .check-in-form .form-item label:after {
        color: #999;
        margin-left: 5px;
      }
      .check-in-form .form-item .required:after {
        content: "(必填)";
      }
      .check-in-form .form-item .none-required:after {
        content: "(选填)";
      }
      .check-in-form .form-item input,
      .check-in-form .form-item textarea {
        display: block;
        width: 100%;
        height: 34px;
        line-height: 32px;
        padding: 0 5px;
        margin: 2px 0 0 0;
        border: 1px solid #ddd;
        border-radius: 3px;;
        font-size: 13px;
      }
      .check-in-form .form-item textarea {
        resize: none;
      }
      .check-in-form .form-item input:focus,
      .check-in-form .form-item textarea:focus {
        outline: none;
        border-color: #0674a7;
      }
      .check-in-form .submit-wrap {
        margin-top: 20px;
        margin-bottom: 10px;
        height: 34px;
        line-height: 34px;
        border-radius: 17px;
        text-align: center;
        color: #fff;
        font-size: 14px;
        background: linear-gradient(to top, #73E0EC 0%,#29B8DA 100%);
      }
      /* 签到成功提示 */
      .checked-tips-dialog {
        position: fixed;
        display: none;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(255, 255, 255, 0.1);
        z-index: 99;
      }
      .checked-tips-dialog.active {
        display: block;
      }
      .checked-tips-dialog .dialog {
        position: absolute;
        height: 360px;
        left: 10vw;
        right: 10vw;
        top: 50%;
        padding: 20px 10px;
        margin-top: -180px;
        border-radius: 10px;
        overflow: hidden;
        background-color: #fff;
      }
      .checked-tips-dialog .checked-title {
        display: flex;
        height: 20px;
        line-height: 20px;
        font-size: 16px;
        font-weight: bold;
        color: #333;
        align-items: center;
        justify-content: center;
      }
      .checked-tips-dialog .checked-in-icon {
        position: relative;
        display: inline-block;
        width: 20px;
        height: 20px;
        margin-right: 3px;
        border-radius: 25px;
        background: #36C5E7;
      }
      .checked-tips-dialog .checked-in-icon:after {
        position: absolute;
        content: "";
        width: 50%;
        height: 25%;
        left: 4px;
        top: 5px;
        border: 2px solid #fff;
        border-radius: 1px;
        border-top: none;
        border-right: none;
        background: transparent;
        transform: rotate(-45deg);
      }
      .checked-tips-dialog .checked-sub-title {
        height: 40px;
        line-height: 20px;
        margin-top: 50px;
        font-size: 14px;
        color: #444;
        text-align: center;
      }
      .checked-tips-dialog .qrcode-wrap {
        display: flex;
        width: 120px;
        height: 120px;
        margin: 40px auto 0;
        align-items: center;
        justify-content: center;
      }
      .checked-tips-dialog .qrcode-wrap img {
        width: 100%;
        height: 100%;
        max-width: 100%;
        max-height: 100%;
      }
    </style>
  </head>
  <body>
    <div class="main" id="main">
      <div class="container" id="container">
        <div class="slogan">
          <img src="https://come-future.oss-cn-beijing.aliyuncs.com/check-in/slogan.png?imgStamp=${imgStamp}"/>
        </div>
        <div class="check-in-title">
          <img src="https://come-future.oss-cn-beijing.aliyuncs.com/check-in/title.png?imgStamp=${imgStamp}"/>
        </div>
        <div class="check-in-sub-title">
          <img src="https://come-future.oss-cn-beijing.aliyuncs.com/check-in/sub-title.png?imgStamp=${imgStamp}"/>
        </div>
        <div class="check-in-date">
          <img src="https://come-future.oss-cn-beijing.aliyuncs.com/check-in/check-in-date.png?imgStamp=${imgStamp}"/>
        </div>
        <div id="scrollDownTips" class="scroll-down-tips">
          <div class="chevron"></div>
          <div class="chevron"></div>
          <div class="chevron"></div>
          <span class="text">
            下滑进行签到
          </span>
        </div>
        <div class="check-in-form">
          <div class="check-form-title">
            <img src="https://come-future.oss-cn-beijing.aliyuncs.com/check-in/check-form-title.png?imgStamp=${imgStamp}"/>
          </div>
          <form id="checkedForm" method="POST" action="/create-record">
            <div class="form-item">
              <label class="required">单位</label>
              <div class="error-tips">请填写单位</div>
              <input type="text" name="company" class="form-input"/>
            </div>
            <div class="form-item">
              <label class="required">职务</label>
              <div class="error-tips">请填写职务</div>
              <input type="text" name="job" class="form-input"/>
            </div>
            <div class="form-item">
              <label class="required">姓名</label>
              <div class="error-tips">请填写姓名</div>
              <input type="text" name="name" class="form-input"/>
            </div>
            <div class="form-item">
              <label class="required">电话</label>
              <div class="error-tips">请填写正确的联系电话</div>
              <input type="text" name="mobile" class="form-input"/>
            </div>
            <div class="form-item">
              <label class="none-required">祝福语</label>
              <textarea type="text" name="congratulation" rows="1" class="form-input"></textarea>
            </div>
            <div class="submit-wrap">
              <div id="submitBtn">提交</div>
            </div>
          </form>
        </div>
      </div>
    </div>
    <div id="checkedDialog" class="checked-tips-dialog">
      <div class="dialog">
        <div class="checked-title">
          <i class="checked-in-icon"></i>
          签到成功
        </div>
        <div class="checked-sub-title">
          长按识别二维码
          <br>
          进入天台医共体讨论群
        </div>
        <div class="qrcode-wrap">
          <img src="https://come-future.oss-cn-beijing.aliyuncs.com/check-in/qrcode.png?imgStamp=${imgStamp}"/>
        </div>
      </div>
    </div>
    <script type="text/javascript">
      var haveCheckedIn = ${haveCheckedIn};
      var $main = document.getElementById('main');
      var $container = document.getElementById('container');
      // 初始化重置滚动条位置
      $main.scrollTo(0, 0);
      // 监听滚动事件
      var prev = 0;
      var current= $main.scrollTop;
      var scrolling = false;
      function slideUp() {
        // do nothing
      }
      function slideDown() {
        $container.className = 'container check-in';

        setTimeout(function() {
          $container.className = 'container';

          $main.scrollTo(0, window.screen.height);
        }, 500);
      }
      var $scrollDownTips = document.getElementById('scrollDownTips');
      $main.onscroll = function() {
        if ($main.scrollTop < window.screen.height * 0.2) {
          $scrollDownTips.className = 'scroll-down-tips';
        } else {
          $scrollDownTips.className = 'scroll-down-tips hidden';
        }

        if (scrolling) return;

        current = $main.scrollTop;

        if (current > prev) {

          scrolling = true;

          slideDown()
        } else {
            slideUp();
        }
        prev = current;
      };
      // 判断用户是否提交了签到
      var submitTag = document.URL.indexOf('checked=true') !== -1;
      var $checkedDialog = document.getElementById('checkedDialog');
      if (submitTag) {
        $checkedDialog.className = 'checked-tips-dialog active';
        $scrollDownTips.className = 'scroll-down-tips hidden';
      }
      // 提交表单
      var $submitBtn = document.getElementById('submitBtn');
      var $checkedForm = document.getElementById('checkedForm');
      var $inputItemArr = $checkedForm.getElementsByClassName('form-input');
      $submitBtn.onclick = function() {
        // 校验字段数据
        for (let i = 0; i < $inputItemArr.length; i++) {
          var $formInputItem = $inputItemArr[i].parentNode;
          var inputType = $inputItemArr[i].getAttribute('name');
          var inputVal = $inputItemArr[i].value;

          switch (inputType) {
            case 'mobile':
              const mobileReg = /^1(3|4|5|6|7|8|9)\d{9}$/;
              if (!mobileReg.test(inputVal.trim())) {
                $formInputItem.className = 'form-item error';
                return;
              }
            default:
              if (inputType !== 'congratulation' && !inputVal.trim()) {
                $formInputItem.className = 'form-item error';
                return;
              }
          }
        }

        $checkedForm.submit();
      };
      for (let i = 0; i < $inputItemArr.length; i++) {
        $inputItemArr[i].onfocus = function(evt) {
          $inputItem = evt.target;

          $inputItem.parentNode.className = 'form-item';
        };
      }
    </script>
  </body>
</html>
